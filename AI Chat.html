<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chat - Industrial Monitoring Web App</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Custom Styles -->
    <style>
        /* Sidebar active item */
        .sidebar-item.active {
            background-color: rgba(59, 130, 246, 0.1);
            border-left: 3px solid #3b82f6;
        }
        
        /* Chat messages */
        .chat-message {
            animation: fadeInSlideUp 0.3s ease-out;
        }
        
        @keyframes fadeInSlideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Dark theme styles - Full Dark Version */
        .brand-dark {
            background-color: #020617;
            background-image: 
                radial-gradient(at 20% 80%, #0f172a 0px, transparent 50%),
                radial-gradient(at 80% 20%, #0f172a 0px, transparent 50%),
                radial-gradient(at 40% 40%, #1e3a8a 0px, transparent 50%);
        }
        
        .text-on-dark {
            color: #f1f5f9;
        }
        
        .text-secondary-on-dark {
            color: #cbd5e1;
        }
        
        .card-on-dark {
            background-color: #0f172a;
            border: 1px solid #1e293b;
            backdrop-filter: blur(10px);
        }
        
        .nav-link-dark {
            color: #cbd5e1;
            transition: color 0.3s ease;
        }
        
        .nav-link-dark:hover {
            color: #f1f5f9;
        }
        
        .nav-link-dark.active {
            color: #3b82f6;
        }
    </style>
</head>
<body class="brand-dark min-h-screen">
    <div id="root"></div>
    <script type="text/javascript">
        // Mock Data
        const mockChatMessages = [
            { id: 1, sender: "ai", text: "Hello! I'm your Industrial AI Assistant. How can I help you today?", timestamp: "10:00 AM" },
            { id: 2, sender: "user", text: "What's the status of Assembly Line C?", timestamp: "10:02 AM" },
            { id: 3, sender: "ai", text: "Assembly Line C is currently showing critical status due to bearing wear detected. I recommend immediate maintenance to prevent downtime.", timestamp: "10:03 AM" }
        ];
        const expertTopics = [
            "Machine Diagnostics",
            "Maintenance Scheduling",
            "Performance Optimization",
            "Energy Consumption",
            "Predictive Analysis",
            "Fault Detection"
        ];
    </script>
    <script type="text/babel">
        // Navigation Bar Component
        const NavBar = () => {
            const navLinks = [
                { name: "Home", path: "index.html" },
                { name: "Dashboard", path: "dashboard.html" },
                { name: "Analytics", path: "Analytics.html" },
                { name: "Alerts", path: "Alerts.html" },
                { name: "AI Chat", path: "AI Chat.html" },
                { name: "Settings", path: "Settings.html" }
            ];
            
            // Get current page to highlight active link
            const getCurrentPage = () => {
                const path = window.location.pathname;
                const filename = path.substring(path.lastIndexOf('/') + 1);
                return filename === '' ? 'index.html' : filename;
            };
            
            const currentPage = getCurrentPage();
            
            return (
                <nav className="sticky top-0 z-50 bg-slate-950/90 backdrop-blur-md shadow-lg">
                    <div className="container mx-auto px-4 py-3 flex justify-between items-center">
                        <div className="flex items-center space-x-10">
                            <div className="flex items-center">
                                <i data-lucide="activity" className="w-8 h-8 text-blue-500 mr-2"></i>
                                <span className="text-xl font-bold text-on-dark">Industrial Chatbot</span>
                            </div>
                            
                            <div className="hidden md:flex space-x-8 relative">
                                {navLinks.map((link) => (
                                    <a 
                                        key={link.name}
                                        href={link.path}
                                        className={`nav-link nav-link-dark px-1 py-2 ${currentPage === link.path ? 'active' : ''}`}
                                    >
                                        {link.name}
                                    </a>
                                ))}
                            </div>
                        </div>
                        
                        <div className="flex items-center space-x-4">
                            <a 
                                href="login.html"
                                className="text-secondary-on-dark hover:text-on-dark transition-colors"
                            >
                                Sign In
                            </a>
                            <a 
                                href="signup.html"
                                className="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors"
                            >
                                Sign Up
                            </a>
                        </div>
                    </div>
                </nav>
            );
        };

        // Subscription Check Component
        const SubscriptionCheck = ({ children }) => {
            const [hasSubscription, setHasSubscription] = React.useState(false);
            const [isLoading, setIsLoading] = React.useState(true);
            
            React.useEffect(() => {
                // Check subscription status
                const savedSubscription = localStorage.getItem('subscription');
                if (savedSubscription) {
                    try {
                        const subscription = JSON.parse(savedSubscription);
                        const now = new Date();
                        const subDate = new Date(subscription.timestamp);
                        const daysSinceSub = Math.floor((now - subDate) / (1000 * 60 * 60 * 24));
                        
                        setHasSubscription(daysSinceSub <= 30);
                    } catch (e) {
                        console.error('Error parsing subscription data:', e);
                        setHasSubscription(false);
                    }
                } else {
                    setHasSubscription(false);
                }
                setIsLoading(false);
            }, []);
            
            if (isLoading) {
                return (
                    <div className="flex items-center justify-center h-screen">
                        <div className="text-center">
                            <div className="w-16 h-16 border-t-4 border-blue-500 border-solid rounded-full animate-spin mx-auto mb-4"></div>
                            <p className="text-secondary-on-dark">Loading...</p>
                        </div>
                    </div>
                );
            }
            
            if (!hasSubscription) {
                return (
                    <div className="flex flex-col items-center justify-center h-screen p-8">
                        <div className="max-w-md w-full card-on-dark rounded-xl shadow-md p-8 text-center">
                            <div className="w-16 h-16 bg-blue-900 rounded-full flex items-center justify-center mx-auto mb-6">
                                <i data-lucide="lock" className="w-8 h-8 text-blue-400"></i>
                            </div>
                            <h2 className="text-2xl font-bold text-on-dark mb-4">Subscription Required</h2>
                            <p className="text-secondary-on-dark mb-6">
                                You need an active subscription to access the AI Chat feature. Please subscribe to one of our plans to unlock this feature.
                            </p>
                            <div className="space-y-4">
                                <button 
                                    className="w-full bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg transition-colors"
                                    onClick={() => window.location.href = "subscription.html"}
                                >
                                    View Subscription Plans
                                </button>
                                <button 
                                    className="w-full bg-slate-800 hover:bg-slate-700 text-on-dark px-6 py-3 rounded-lg transition-colors"
                                    onClick={() => window.location.href = "dashboard.html"}
                                >
                                    Back to Dashboard
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }
            
            return children;
        };

        // AI Chat Component
        const AIChat = () => {
            const [message, setMessage] = React.useState('');
            const [messages, setMessages] = React.useState(mockChatMessages);
            
            React.useEffect(() => {
                // Initialize Lucide icons
                lucide.createIcons();
                
                // Scroll to bottom of chat
                const chatContainer = document.getElementById('chat-container');
                if (chatContainer) {
                    chatContainer.scrollTop = chatContainer.scrollHeight;
                }
            }, [messages]);
            
            const handleSendMessage = () => {
                if (message.trim() === '') return;
                
                const newMessage = {
                    id: messages.length + 1,
                    sender: 'user',
                    text: message,
                    timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                };
                
                setMessages([...messages, newMessage]);
                setMessage('');
                
                // Simulate AI response after a delay
                setTimeout(() => {
                    const aiResponse = {
                        id: messages.length + 2,
                        sender: 'ai',
                        text: "I'm analyzing your request. This is a simulated response from the AI assistant.",
                        timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
                    };
                    setMessages(prev => [...prev, aiResponse]);
                }, 1000);
            };
            
            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };
            
            return (
                <div className="flex h-screen">
                    <NavBar />
                    
                    <div className="flex-1 flex flex-col">
                        {/* Chat Header */}
                        <div className="card-on-dark border-b border-slate-800 p-4">
                            <div className="flex items-center">
                                <div className="w-10 h-10 bg-blue-900 rounded-full flex items-center justify-center mr-3">
                                    <i data-lucide="bot" className="w-5 h-5 text-blue-400"></i>
                                </div>
                                <div>
                                    <h2 className="font-semibold text-on-dark">Industrial AI Assistant</h2>
                                    <p className="text-sm text-secondary-on-dark">Online - Ready to help</p>
                                </div>
                            </div>
                        </div>
                        
                        {/* Chat Messages */}
                        <div id="chat-container" className="flex-1 overflow-y-auto p-4 bg-slate-950">
                            <div className="max-w-3xl mx-auto">
                                {messages.map(msg => (
                                    <div 
                                        key={msg.id} 
                                        className={`mb-4 chat-message ${msg.sender === 'user' ? 'text-right' : ''}`}
                                    >
                                        <div className={`inline-block max-w-xs md:max-w-md px-4 py-2 rounded-lg ${msg.sender === 'user' ? 'bg-blue-600 text-white' : 'card-on-dark border border-slate-700 text-on-dark'}`}>
                                            <p>{msg.text}</p>
                                            <p className={`text-xs mt-1 ${msg.sender === 'user' ? 'text-blue-200' : 'text-slate-400'}`}>{msg.timestamp}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        {/* Chat Input */}
                        <div className="card-on-dark border-t border-slate-800 p-4">
                            <div className="max-w-3xl mx-auto flex">
                                <textarea
                                    value={message}
                                    onChange={(e) => setMessage(e.target.value)}
                                    onKeyPress={handleKeyPress}
                                    className="flex-1 border border-slate-700 rounded-l-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none bg-slate-900 text-on-dark"
                                    placeholder="Type your message here..."
                                    rows={1}
                                />
                                <button
                                    onClick={handleSendMessage}
                                    disabled={message.trim() === ''}
                                    className="bg-blue-600 hover:bg-blue-700 text-white px-6 rounded-r-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                                >
                                    <i data-lucide="send" className="w-5 h-5"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    {/* Expert Topics Sidebar */}
                    <div className="w-64 card-on-dark border-l border-slate-800 p-4">
                        <h3 className="font-semibold text-on-dark mb-4">Expert Topics</h3>
                        <div className="space-y-2">
                            {expertTopics.map((topic, index) => (
                                <button 
                                    key={index}
                                    className="w-full text-left bg-slate-800 hover:bg-slate-700 rounded-lg px-4 py-2 transition-colors text-secondary-on-dark"
                                    onClick={() => setMessage(`Tell me about ${topic.toLowerCase()}`)}
                                >
                                    {topic}
                                </button>
                            ))}
                        </div>
                        
                        <div className="mt-8">
                            <h3 className="font-semibold text-on-dark mb-4">Quick Actions</h3>
                            <div className="space-y-2">
                                <button className="w-full text-left bg-blue-900 hover:bg-blue-800 rounded-lg px-4 py-2 transition-colors text-blue-300">
                                    Check Machine Status
                                </button>
                                <button className="w-full text-left bg-blue-900 hover:bg-blue-800 rounded-lg px-4 py-2 transition-colors text-blue-300">
                                    Schedule Maintenance
                                </button>
                                <button className="w-full text-left bg-blue-900 hover:bg-blue-800 rounded-lg px-4 py-2 transition-colors text-blue-300">
                                    Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component
        const App = () => {
            return (
                <SubscriptionCheck>
                    <AIChat />
                </SubscriptionCheck>
            );
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>

</html>
